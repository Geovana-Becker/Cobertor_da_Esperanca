<!-- /*
* Bootstrap 5
* Template Name: Furni
* Template Author: Untree.co
* Template URI: https://untree.co/
* License: https://creativecommons.org/licenses/by/3.0/
*/ -->
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Untree.co">
    <link rel="shortcut icon" href="favicon.png">

    <meta name="description" content="" />
    <meta name="keywords" content="bootstrap, bootstrap4" />

    <!-- Bootstrap CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link href="css/tiny-slider.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <title>Cobertor da Esperança</title>
</head>

<body>

    <!-- Start Header/Navigation -->
    <nav class="custom-navbar navbar navbar navbar-expand-md navbar-dark bg-dark" arial-label="Furni navigation bar">

        <div class="container">
            <a class="navbar-brand" href="index.html">Cobertor da Esperança<span></span></a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni" aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarsFurni">
                <ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
                    <li class="nav-item">
                        <a class="nav-link" id="home_menu" href="index.html">Home</a>
                    </li>
                    <li><a class="nav-link" id="doacao-menu" style="display: block;" href="doacao.html">Doações</a></li>
                    <li><a class="nav-link" href="recompensas.html">Recompensas</a></li>
                    <li><a class="nav-link" id="contato-menu" style="display: block;" href="contato.html">Contato</a></li>
                    <li><a class="nav-link" id="cadastro-recompensas" href="cadastrorecompensas.html" style="display: none;">Cadastro de recompensas</a></li>
                    <li class="active"><a class="nav-link" id="gerenciamento-usuarios" href="recompensasfunc.html" style="display: none;">Gerenciamento de usuários</a></li>
                </ul>

                <ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
                    <li><a class="nav-link" id="botao_login" style="display: block;" href="login.html"><img src="images/user.svg"></a></li>
                </ul>
                <ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
                    <li><a class="nav-link" id="botao_sair" onclick="logout()" style="cursor: pointer; display: none;">Sair</a></li>
                </ul>
            </div>
        </div>

    </nav>
    <!-- End Header/Navigation -->
    <!-- Start Hero Section -->
    <div class="hero">
        <div class="container">
            <div class="row justify-content-between">
                <div class="col-lg-5">
                    <div class="intro-excerpt">
                        <h1>Gerenciamento de Usuários</h1>
                        <p class="mb-4">Página para gerenciar os usuários cadastrados.</p>
                        <p><a href="login.html" id="botao-entrar2" class="btn btn-white-outline">Entrar</a></p>
                    </div>
                </div>
                <div class="col-lg-7">
                    <div class="hero-img-wrap">
                        <img src="images/couch.png" class="img-fluid">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Hero Section -->

    <br>
    <div class="row mb-5" id="usuarios-cadastrados">
        <form class="col-md-12">
            <div class="site-blocks-table">
                <table class="table">
                    <thead>
                        <tr>
                            <th class="product-name">ID</th>
                            <th class="product-name">Nome</th>
                            <th class="product-price">CPF</th>
                            <th class="product-quantity">Pontuação</th>
                            <th class="product-quantity">Remover</th>
                        </tr>
                    </thead>
                    <tbody id="usuarios-veyr">
                    </tbody>
                </table>
            </div>
        </form>
        <div class="row" id="atualizacao-usuario">
            <div class="col-lg-8">
                <div class="subscription-form">
                    <h3 class="d-flex align-items-center"><span>Atualizar pontuação do usuário</span></h3>

                    <form id="atualizarUsuario" class="row g-3">
                        <div class="col-auto">
                            <input type="number" id="id-usuario1" class="form-control" placeholder="Digite o ID do usuário.">
                        </div>
                        <div class="col-auto">
                            <input type="number" id="pontuacao-usuario" class="form-control" placeholder="Digite a nova pontuação do usuário.">
                        </div>
                        <div class="col-auto">
                            <button onclick="updateUsuario(event)" class="btn btn-primary">
                                <span class="fa fa-paper-plane"></span>
                            </button>
                        </div>
                    </form>

                </div>
            </div>
        </div>
    </div>

    <!-- recompensas -->
    <!-- recompensas-->
    <!-- Start Footer Section -->
    <footer class="footer-section">
        <div class="container relative">

            <div class="sofa-img">
                <img src="images/sofa.png" alt="Image" class="img-fluid">
            </div>

            <div class="row g-5 mb-5">
                <div class="col-lg-4">
                    <div class="mb-4 footer-logo-wrap"><a href="#" class="footer-logo">Cobertor da Esperança<span></span></a></div>
                    <p class="mb-4">Compartilhe amor, aqueça corações. Cada peça doada é um passo para um mundo mais gentil. Obrigado por fazer parte dessa corrente do bem!</p>
                </div>

                <div class="col-lg-8">
                    <div class="row links-wrap">
                        <div class="col-6 col-sm-6 col-md-3">
                            <ul class="list-unstyled">
                                <li><a href="recompensas.html">Recompensas</a></li>
                            </ul>
                        </div>
                    </div>
                </div>

            </div>

            <div class="border-top copyright">
                <div class="row pt-4">
                    <div class="col-lg-6">
                        <p class="mb-2 text-center text-lg-start">
                            Copyright &copy;
                            <script>document.write(new Date().getFullYear());</script> Cobertor da Esperança.  Todos os direitos reservados.
                        </p>
                    </div>



                </div>
            </div>

        </div>
    </footer>
    <!-- End Footer Section -->
	<!--ancora-->
  <a href="#" class="back-to-top">
	<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
		<path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5"/>
	</svg>
</a>
<!--ancora-->
    <script>
        function getUsuarios() {
            fetch('https://localhost:7177/UsuariosCadastrados')
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    const usuarioscadastrados = document.getElementById('usuarios-veyr');
                    usuarioscadastrados.innerHTML = '';



                    data.forEach(usuariocad => {
                        const usuario = document.createElement('tr');
                        usuario.innerHTML = `
                            <td id="usuario-id" class="product-name">${usuariocad.id}</td>
                            <td class="product-name">${usuariocad.nome}</td>
                            <td>${usuariocad.cpf}</td>
                            <td>${usuariocad.pontuacao}</td>
                            <td><button onclick="deleteUsuario(${usuariocad.id})">X</button></td>
                                `;
                        usuarioscadastrados.appendChild(usuario);
                    });
                });
        }
        function updateUsuario(event) {
            event.preventDefault(); 
            const id = parseInt(document.getElementById('id-usuario1').value); 
            const pontuacao = parseInt(document.getElementById('pontuacao-usuario').value); 

            if (!id || isNaN(pontuacao)) {
                alert('Por favor, preencha os campos corretamente.');
                return;
            }

            const usuario = {
                "id": 0,
                "nome": "string",
                "cpf": "string",
                "telefone": "string",
                "email": "string",
                "senha": "string",
                "pontuacao": pontuacao
            }; 
            fetch(`https://localhost:7177/UsuariosCadastrados/${id}`, {
                method: 'PUT', 
                headers: {
                    'Content-Type': 'application/json', 
                },
                body: JSON.stringify(usuario), 
            })
                .then(response => {
                    if (response.ok) {
                        alert('Pontuação atualizada com sucesso!');
                        document.getElementById('id-usuario1').value = '';
                        document.getElementById('pontuacao-usuario').value = '';
                        getUsuarios(); 
                    } else if (response.status === 404) {
                        alert('Usuário não encontrado.');
                    } else {
                        alert('Erro ao atualizar pontuação. Verifique os dados.');
                    }
                })
                .catch(error => {
                    console.error('Erro:', error);
                    alert('Erro na comunicação com o servidor.');
                });
        }
        function deleteUsuario(id) {
            fetch(`https://localhost:7177/UsuariosCadastrados/${id}`, {
                method: "DELETE"
            }).then(response => {
                if (response.ok) {
                    getUsuarios();
                }
            });
        }

        getUsuarios();

    </script>

    <script src="js/funcionarios.js"></script>
    <script src="js/sistema.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/tiny-slider.js"></script>
    <script src="js/custom.js"></script>
</body>

</html>

